<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Insertion Sort</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Kanit&display=swap');
  body {
    font-family: 'Kanit', sans-serif;
    background: linear-gradient(135deg, #fdf2f8 0%, #f0f9ff 30%, #f0fdf4 100%);
    margin: 0; padding: 20px;
    display: flex; justify-content: center; align-items: flex-start;
    min-height: 100vh;
  }
  .container {
    background: white;
    border-radius: 20px;
    box-shadow: 0 15px 40px rgba(0,0,0,0.1);
    padding: 30px;
    max-width: 600px;
    width: 100%;
  }
  h2,h3 {
    text-align: center;
    color: #8b7ab8;
  }
  input, select, button {
    font-family: 'Kanit', sans-serif;
    font-size: 1rem;
    padding: 12px;
    border-radius: 15px;
    border: 2px solid #ddd;
    margin-bottom: 20px;
    width: 100%;
    box-sizing: border-box;
  }
  button {
    background: linear-gradient(135deg, #ddd6fe 0%, #bfdbfe 50%, #d1fae5 100%);
    cursor: pointer;
    color: #4b5563;
    font-weight: 600;
    transition: 0.3s;
  }
  button:hover {
    background: linear-gradient(135deg, #a78bfa 0%, #818cf8 50%, #6ee7b7 100%);
    color: #1f2937;
  }
  button:disabled {
    background: #f3f4f6;
    color: #9ca3af;
    cursor: not-allowed;
  }
  .number-box {
    display: flex;
    justify-content: center;
    gap: 10px;
    flex-wrap: wrap;
    margin: 20px 0;
  }
  .number {
    background: #f3f4f6;
    border-radius: 15px;
    padding: 20px 25px;
    font-weight: 700;
    font-size: 1.3rem;
    border: 2px solid #e5e7eb;
    position: relative;
    user-select: none;
  }
  .sorted {
    background: #a7f3d0;
    border-color: #059669;
    color: #064e3b;
  }
  .comparing {
    background: #fde68a;
    border-color: #ca8a04;
    color: #78350f;
    animation: pulse 1.5s infinite;
  }
  @keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
  }
  .arrow {
    position: absolute;
    top: -30px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 24px;
    color: #8b7ab8;
    animation: bounce 1.5s infinite;
  }
  @keyframes bounce {
    0%, 100% { transform: translateX(-50%) translateY(0); }
    50% { transform: translateX(-50%) translateY(-8px); }
  }
  #explanation {
    background: #f0f9ff;
    border-radius: 15px;
    padding: 15px;
    text-align: center;
    font-size: 1.1rem;
    color: #475569;
    min-height: 70px;
  }
  .stats {
    display: flex;
    justify-content: space-around;
    margin-bottom: 20px;
    color: #6b7280;
    font-weight: 600;
  }
  .stats div {
    background: #fef3c7;
    padding: 10px 20px;
    border-radius: 15px;
    flex: 1;
    margin: 0 5px;
    text-align: center;
  }
  #cppCode {
    background: #1e293b;
    color: #f8fafc;
    font-family: 'Courier New', Courier, monospace;
    border-radius: 15px;
    padding: 15px;
    margin-top: 30px;
    max-height: 250px;
    overflow-y: auto;
  }
  #finalScoreScreen {
    text-align: center;
  }
  #finalScoreScreen h2 {
    color: #10b981;
  }
  #finalScoreScreen p {
    font-size: 1.3rem;
    margin-top: 15px;
  }
</style>
</head>
<body>

<div class="container" id="menuScreen">
  <h2>üå∏Insertion Sortüå∏</h2>
  <input type="text" id="playerName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" />
  <select id="classSelect">
    <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô --</option>
    <option value="‡∏õ‡∏ß‡∏ä.1/1">‡∏õ‡∏ß‡∏ä.1/1</option>
    <option value="‡∏õ‡∏ß‡∏ä.1/2">‡∏õ‡∏ß‡∏ä.1/2</option>
    <option value="‡∏õ‡∏ß‡∏ä.2/1">‡∏õ‡∏ß‡∏ä.2/1</option>
  </select>
  <button id="btnRules" type="button">üìö ‡∏≠‡πà‡∏≤‡∏ô‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô</button>
  <button id="btnStart" type="button">üéÆ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button>
</div>

<div class="container" id="rulesScreen" style="display:none;">
  <h2>üìñ ‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô</h2>
  <p>‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÅ‡∏ö‡∏ö‡πÅ‡∏ó‡∏£‡∏Å (Insertion Sort) ‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏°‡πÅ‡∏ö‡∏ö‡πÇ‡∏ï‡πâ‡∏ï‡∏≠‡∏ö</p>
  <ul>
    <li>‡πÄ‡∏Å‡∏°‡∏°‡∏µ 3 ‡∏î‡πà‡∏≤‡∏ô ‡∏¢‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢ ‡πÜ</li>
    <li>‡∏ï‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ô‡∏î‡πà‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏õ‡∏î‡πà‡∏≤‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</li>
    <li>‡∏Å‡∏î "‡∏™‡∏•‡∏±‡∏ö" ‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏•‡∏±‡∏ö‡πÄ‡∏•‡∏Ç‡∏™‡∏≠‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö</li>
    <li>‡∏Å‡∏î "‡πÑ‡∏°‡πà‡∏™‡∏•‡∏±‡∏ö" ‡∏´‡∏≤‡∏Å‡πÄ‡∏•‡∏Ç‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß</li>
    <li>‡∏Å‡∏î "‡πÅ‡∏ó‡∏£‡∏Å" ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏õ‡πÄ‡∏•‡∏Ç‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</li>
  </ul>
  <button id="btnBackToMenu" type="button">üîô ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
  <button id="btnPlayNow" type="button">üéÆ ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏•‡∏¢</button>
</div>

<div class="container" id="gameScreen" style="display:none;">
  <h3 id="playerInfo"></h3>
  <div class="stats">
    <div>‡∏î‡πà‡∏≤‡∏ô <br /><span id="currentLevel">1</span>/3</div>
    <div>‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà <br /><span id="totalMoves">0</span></div>
  </div>

  <div class="number-box" id="numberBox"></div>
  <div id="explanation">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</div>

  <div>
    <button id="btnSwap" type="button">üîÑ ‡∏™‡∏•‡∏±‡∏ö</button>
    <button id="btnNoSwap" type="button">‚úÖ ‡πÑ‡∏°‡πà‡∏™‡∏•‡∏±‡∏ö</button>
    <button id="btnInsert" type="button" disabled>üìç ‡πÅ‡∏ó‡∏£‡∏Å</button>
    <button id="btnShuffle" type="button">üé≤ ‡∏™‡∏∏‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>
  </div>
  <button id="btnBackMenu" type="button" style="margin-top:15px;">üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
</div>

<div class="container" id="finalScoreScreen" style="display:none;">
  <h2>üéâ ‡∏à‡∏ö‡πÄ‡∏Å‡∏°‡πÅ‡∏•‡πâ‡∏ß! üéâ</h2>
  <p id="finalMessage"></p>
  <button id="btnRestart" type="button">‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà</button>
  <button id="btnBackMenu2" type="button">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
</div>

<script>
  let playerName = '';
  let playerClass = '';
  let numbers = [];
  let currentIndex = 1; // i ‡πÉ‡∏ô insertion sort
  let currentInner = 1; // j ‡πÉ‡∏ô insertion sort + 1 (‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö)
  let inserted = false;
  let totalMoves = 0;
  let score = 0;
  let currentLevel = 1;
  let totalScore = 0; // ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∞‡∏™‡∏°‡∏£‡∏ß‡∏°‡∏ó‡∏∏‡∏Å‡∏î‡πà‡∏≤‡∏ô

  const menuScreen = document.getElementById('menuScreen');
  const rulesScreen = document.getElementById('rulesScreen');
  const gameScreen = document.getElementById('gameScreen');
  const finalScoreScreen = document.getElementById('finalScoreScreen');

  function showMenu() {
    menuScreen.style.display = 'block';
    rulesScreen.style.display = 'none';
    gameScreen.style.display = 'none';
    finalScoreScreen.style.display = 'none';
  }
  function showRules() {
    menuScreen.style.display = 'none';
    rulesScreen.style.display = 'block';
    gameScreen.style.display = 'none';
    finalScoreScreen.style.display = 'none';
  }
  function showGame() {
    menuScreen.style.display = 'none';
    rulesScreen.style.display = 'none';
    gameScreen.style.display = 'block';
    finalScoreScreen.style.display = 'none';
  }

  document.getElementById('btnRules').onclick = showRules;
  document.getElementById('btnBackToMenu').onclick = showMenu;
  document.getElementById('btnPlayNow').onclick = () => {
    if(!validateInputs()) return;
    startGame();
    showGame();
  };
  document.getElementById('btnStart').onclick = () => {
    if(!validateInputs()) return;
    startGame();
    showGame();
  };
  document.getElementById('btnBackMenu').onclick = () => {
    if(confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÄ‡∏Å‡∏°‡πÅ‡∏•‡∏∞‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å?')) {
      showMenu();
    }
  };
  document.getElementById('btnBackMenu2').onclick = () => {
    showMenu();
  };
  document.getElementById('btnRestart').onclick = () => {
    currentLevel = 1;
    totalScore = 0;
    startGame();
    showGame();
  };

  function validateInputs() {
    playerName = document.getElementById('playerName').value.trim();
    playerClass = document.getElementById('classSelect').value;
    if(!playerName || !playerClass) {
      alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏∞ üå∏');
      return false;
    }
    return true;
  }

  function generateUniqueNumbers(count) {
    const arr = [];
    const maxNum = currentLevel === 1 ? 50 : currentLevel === 2 ? 75 : 99;
    while(arr.length < count) {
      let r = Math.floor(Math.random() * maxNum) + 1;
      if(!arr.includes(r)) arr.push(r);
    }
    return arr;
  }

  function startGame() {
    score = 0;
    totalMoves = 0;
    currentIndex = 1;
    currentInner = 1;
    inserted = false;
    const count = currentLevel === 1 ? 5 : currentLevel === 2 ? 6 : 7;
    numbers = generateUniqueNumbers(count);
    updateUI();
    document.getElementById('playerInfo').textContent = `üëã ${playerName} | üè´ ${playerClass}`;
  }

  function handleSwap() {
    if(currentInner > 0 && numbers[currentInner] < numbers[currentInner - 1]) {
      [numbers[currentInner], numbers[currentInner - 1]] = [numbers[currentInner - 1], numbers[currentInner]];
      currentInner--;
      inserted = false;
      totalMoves++;
      score += 10;
      updateUI();
    } else {
      alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç üòÖ');
      score = Math.max(0, score - 5);
      updateUI();
    }
  }

  }

  function handleInsert() {
    if(currentInner > 0 && numbers[currentInner] < numbers[currentInner - 1]) {
      alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ñ‡∏π‡∏Å ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏•‡∏±‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡πÑ‡∏°‡πà‡∏™‡∏•‡∏±‡∏ö" ‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞! üìç');
      return;
    }
    currentIndex++;
    if(currentIndex >= numbers.length) {
      completeLevel();
      return;
    }
    currentInner = currentIndex;
    inserted = false;
    updateUI();
  }

  function updateUI() {
    const box = document.getElementById('numberBox');
    box.innerHTML = '';
    for(let i=0; i<numbers.length; i++) {
      const div = document.createElement('div');
      div.textContent = numbers[i];
      div.className = 'number';
      if(i < currentIndex) div.classList.add('sorted');
      if(i === currentInner && !inserted) div.classList.add('comparing');
      if(i === currentInner && inserted) div.classList.add('sorted');

      if(i === currentInner && !inserted) {
        const arrow = document.createElement('div');
        arrow.className = 'arrow';
        arrow.textContent = '‚¨áÔ∏è';
        div.appendChild(arrow);
      }
      box.appendChild(div);
    }
    const explanation = document.getElementById('explanation');
    if(currentIndex >= numbers.length) {
      explanation.textContent = `üéâ ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß! ‡∏£‡∏ß‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà ${totalMoves} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á`;
    } else if(!inserted) {
      if(currentInner > 0) {
        explanation.textContent = `üîç ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏•‡∏Ç ${numbers[currentInner]} ‡∏Å‡∏±‡∏ö ${numbers[currentInner - 1]}`;
      } else {
        explanation.textContent = `üìç ‡πÄ‡∏•‡∏Ç ${numbers[currentInner]} ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏£‡∏Å‡πÅ‡∏•‡πâ‡∏ß`;
      }
    } else {
      explanation.textContent = `‚úÖ ‡πÄ‡∏•‡∏Ç ${numbers[currentInner]} ‡∏ñ‡∏π‡∏Å‡πÅ‡∏ó‡∏£‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢! ‡πÑ‡∏õ‡πÄ‡∏•‡∏Ç‡∏ï‡∏±‡∏ß‡∏ñ‡∏±‡∏î‡πÑ‡∏õ`;
    }
    document.getElementById('currentScore').textContent = score;
    document.getElementById('totalScore').textContent = totalScore;
    document.getElementById('currentLevel').textContent = currentLevel;
    document.getElementById('totalMoves').textContent = totalMoves;

    // ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡∏õ‡∏∏‡πà‡∏°
    document.getElementById('btnInsert').disabled = !inserted;
    document.getElementById('btnSwap').disabled = inserted;
    document.getElementById('btnNoSwap').disabled = inserted;
  }

  document.getElementById('btnSwap').onclick = handleSwap;
  document.getElementById('btnNoSwap').onclick = handleNoSwap;
  document.getElementById('btnInsert').onclick = handleInsert;
  document.getElementById('btnShuffle').onclick = () => {
    if(confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏Ç‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ä‡πà‡πÑ‡∏´‡∏°?')) startGame();
  };
  
  // ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏°‡∏ô‡∏π‡∏ï‡∏≠‡∏ô‡πÇ‡∏´‡∏•‡∏î
  showMenu();
</script>

</body>
</html>

